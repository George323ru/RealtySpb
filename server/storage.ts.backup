import { 
  users, properties, newBuildings, services, teamMembers, leads, reviews, blogPosts, promotions,
  type User, type InsertUser, type Property, type InsertProperty,
  type NewBuilding, type InsertNewBuilding, type Service, type InsertService,
  type TeamMember, type InsertTeamMember, type Lead, type InsertLead,
  type Review, type InsertReview, type BlogPost, type InsertBlogPost,
  type Promotion, type InsertPromotion
} from "@shared/schema";
import { storageLogger } from "./logger";

export interface IStorage {
  // Users
  getUser(id: number): Promise<User | undefined>;
  getUserByUsername(username: string): Promise<User | undefined>;
  createUser(user: InsertUser): Promise<User>;

  // Properties
  getProperties(filters?: {
    propertyType?: string;
    district?: string;
    priceFrom?: number;
    priceTo?: number;
    buildingType?: string;
    rooms?: number;
  }): Promise<Property[]>;
  getProperty(id: number): Promise<Property | undefined>;
  createProperty(property: InsertProperty): Promise<Property>;

  // New Buildings
  getNewBuildings(): Promise<NewBuilding[]>;
  getNewBuilding(id: number): Promise<NewBuilding | undefined>;
  createNewBuilding(building: InsertNewBuilding): Promise<NewBuilding>;

  // Services
  getServices(): Promise<Service[]>;
  getService(id: number): Promise<Service | undefined>;
  createService(service: InsertService): Promise<Service>;

  // Team Members
  getTeamMembers(): Promise<TeamMember[]>;
  getTeamMember(id: number): Promise<TeamMember | undefined>;
  createTeamMember(member: InsertTeamMember): Promise<TeamMember>;

  // Leads
  getLeads(): Promise<Lead[]>;
  createLead(lead: InsertLead): Promise<Lead>;

  // Reviews
  getReviews(): Promise<Review[]>;
  createReview(review: InsertReview): Promise<Review>;

  // Blog Posts
  getBlogPosts(): Promise<BlogPost[]>;
  getBlogPost(slug: string): Promise<BlogPost | undefined>;
  createBlogPost(post: InsertBlogPost): Promise<BlogPost>;

  // Promotions
  getPromotions(category?: string): Promise<Promotion[]>;
  getPromotion(id: number): Promise<Promotion | undefined>;
  createPromotion(promotion: InsertPromotion): Promise<Promotion>;
}

export class MemStorage implements IStorage {
  private users: Map<number, User>;
  private properties: Map<number, Property>;
  private newBuildings: Map<number, NewBuilding>;
  private services: Map<number, Service>;
  private teamMembers: Map<number, TeamMember>;
  private leads: Map<number, Lead>;
  private reviews: Map<number, Review>;
  private blogPosts: Map<number, BlogPost>;
  private promotions: Map<number, Promotion>;
  private currentId: number;

  constructor() {
    storageLogger.processStart('Memory storage initialization');
    
    this.users = new Map();
    this.properties = new Map();
    this.newBuildings = new Map();
    this.services = new Map();
    this.teamMembers = new Map();
    this.leads = new Map();
    this.reviews = new Map();
    this.blogPosts = new Map();
    this.promotions = new Map();
    this.currentId = 1;
    
    this.initializeData();
    storageLogger.processEnd('Memory storage initialization');
  }

  private initializeData() {
    storageLogger.info('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö');
    // Initialize with sample data for demonstration
    this.initializeProperties();
    this.initializeNewBuildings();
    this.initializeServices();
    this.initializeTeamMembers();
    this.initializeReviews();
    this.initializeBlogPosts();
    this.initializePromotions();
    
    storageLogger.info('–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', {
      properties: this.properties.size,
      newBuildings: this.newBuildings.size,
      services: this.services.size,
      teamMembers: this.teamMembers.size,
      reviews: this.reviews.size,
      blogPosts: this.blogPosts.size,
      promotions: this.promotions.size
    });
  }

  private initializeProperties() {
    const sampleProperties: Property[] = [
      {
        id: this.currentId++,
        title: "3-–∫–æ–º–Ω–∞—Ç–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ",
        description: "–ü—Ä–æ—Å—Ç–æ—Ä–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ —Å –æ—Ç–ª–∏—á–Ω—ã–º —Ä–µ–º–æ–Ω—Ç–æ–º –∏ –≤–∏–¥–æ–º –Ω–∞ –ù–µ–≤—É",
        price: 12500000,
        pricePerMeter: 141667,
        address: "—É–ª. –†—É–±–∏–Ω—à—Ç–µ–π–Ω–∞, 15",
        district: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π",
        propertyType: "apartment",
        rooms: 3,
        area: "88.2",
        floor: 7,
        totalFloors: 12,
        buildingType: "–Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∞",
        images: ["https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=800"],
        features: ["–ï–≤—Ä–æ—Ä–µ–º–æ–Ω—Ç", "–ë–∞–ª–∫–æ–Ω", "–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        title: "–ó–∞–≥–æ—Ä–æ–¥–Ω—ã–π –¥–æ–º –≤ –ü—É—à–∫–∏–Ω–µ",
        description: "–î–æ–º —Å —É—á–∞—Å—Ç–∫–æ–º –≤ —Ç–∏—Ö–æ–º —Ä–∞–π–æ–Ω–µ",
        price: 24900000,
        pricePerMeter: 138333,
        address: "–ø–æ—Å. –ü–∞–≤–ª–æ–≤—Å–∫, —É–ª. –°–∞–¥–æ–≤–∞—è",
        district: "–ü—É—à–∫–∏–Ω—Å–∫–∏–π",
        propertyType: "house",
        rooms: 5,
        area: "180.0",
        floor: 2,
        totalFloors: 2,
        buildingType: "–≤—Ç–æ—Ä–∏—á–∫–∞",
        images: ["https://images.unsplash.com/photo-1449844908441-8829872d2607?w=800"],
        features: ["–£—á–∞—Å—Ç–æ–∫ 10 —Å–æ—Ç–æ–∫", "–ì–∞—Ä–∞–∂", "–ë–∞–Ω—è"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        title: "–û—Ñ–∏—Å–Ω–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ –Ω–∞ –ù–µ–≤—Å–∫–æ–º",
        description: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –æ—Ñ–∏—Å –≤ –±–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä–µ –∫–ª–∞—Å—Å–∞ –ê",
        price: 18500000,
        pricePerMeter: 185000,
        address: "–ù–µ–≤—Å–∫–∏–π –ø—Ä., 28",
        district: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π",
        propertyType: "office",
        rooms: null,
        area: "100.0",
        floor: 8,
        totalFloors: 15,
        buildingType: "–±–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä",
        images: ["https://images.unsplash.com/photo-1497366216548-37526070297c?w=800"],
        features: ["–ü–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ open space", "–ö–æ–Ω–¥–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ", "–û—Ö—Ä–∞–Ω–∞ 24/7", "–ü–∞—Ä–∫–æ–≤–∫–∞"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        title: "–¢–æ—Ä–≥–æ–≤–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ –Ω–∞ –ø–µ—Ä–≤–æ–π –ª–∏–Ω–∏–∏",
        description: "–ü–æ–º–µ—â–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞",
        price: 25000000,
        pricePerMeter: 312500,
        address: "—É–ª. –ë–æ–ª—å—à–∞—è –ö–æ–Ω—é—à–µ–Ω–Ω–∞—è, 5",
        district: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π",
        propertyType: "retail",
        rooms: null,
        area: "80.0",
        floor: 1,
        totalFloors: 6,
        buildingType: "–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –∑–¥–∞–Ω–∏–µ",
        images: ["https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=800"],
        features: ["–í–∏—Ç—Ä–∏–Ω–∞", "–û—Ç–¥–µ–ª—å–Ω—ã–π –≤—Ö–æ–¥", "–í—ã—Å–æ–∫–∏–µ –ø–æ—Ç–æ–ª–∫–∏", "–¶–µ–Ω—Ç—Ä –≥–æ—Ä–æ–¥–∞"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        title: "–°–∫–ª–∞–¥—Å–∫–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ –≤ –ø—Ä–æ–º–∑–æ–Ω–µ",
        description: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∫–ª–∞–¥ —Å —Ä–∞–º–ø–æ–π –∏ –æ—Ñ–∏—Å–Ω–æ–π —á–∞—Å—Ç—å—é",
        price: 15000000,
        pricePerMeter: 30000,
        address: "–ò–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–π –ø—Ä., 45",
        district: "–ö—Ä–∞—Å–Ω–æ—Å–µ–ª—å—Å–∫–∏–π",
        propertyType: "warehouse",
        rooms: null,
        area: "500.0",
        floor: 1,
        totalFloors: 1,
        buildingType: "–ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–µ",
        images: ["https://images.unsplash.com/photo-1586528116311-ad8dd3c8310d?w=800"],
        features: ["–ê–≤—Ç–æ–ø–æ–≥—Ä—É–∑—á–∏–∫", "–†–∞–º–ø–∞", "–û—Ñ–∏—Å–Ω–∞—è –∑–æ–Ω–∞", "–û—Ö—Ä–∞–Ω—è–µ–º–∞—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        title: "–†–µ—Å—Ç–æ—Ä–∞–Ω –≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–º —Ü–µ–Ω—Ç—Ä–µ",
        description: "–ì–æ—Ç–æ–≤—ã–π —Ä–µ—Å—Ç–æ—Ä–∞–Ω —Å –ø–æ–ª–Ω—ã–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º",
        price: 35000000,
        pricePerMeter: 175000,
        address: "–ö–∞–∑–∞–Ω—Å–∫–∞—è —É–ª., 7",
        district: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π",
        propertyType: "restaurant",
        rooms: null,
        area: "200.0",
        floor: 1,
        totalFloors: 4,
        buildingType: "–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –∑–¥–∞–Ω–∏–µ",
        images: ["https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=800"],
        features: ["–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫—É—Ö–Ω—è", "–ó–∞–ª –Ω–∞ 50 –º–µ—Å—Ç", "–¢–µ—Ä—Ä–∞—Å–∞", "–õ–∏—Ü–µ–Ω–∑–∏—è"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        title: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ",
        description: "–¶–µ—Ö —Å –∫—Ä–∞–Ω-–±–∞–ª–∫–æ–π –∏ –ø–æ–¥—ä–µ–∑–¥–Ω—ã–º–∏ –ø—É—Ç—è–º–∏",
        price: 22000000,
        pricePerMeter: 44000,
        address: "–®—É–≤–∞–ª–æ–≤—Å–∫–∏–π –ø—Ä., 88",
        district: "–í—ã–±–æ—Ä–≥—Å–∫–∏–π",
        propertyType: "production",
        rooms: null,
        area: "500.0",
        floor: 1,
        totalFloors: 1,
        buildingType: "–ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–µ",
        images: ["https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800"],
        features: ["–ö—Ä–∞–Ω-–±–∞–ª–∫–∞ 5—Ç", "220/380–í", "–ñ/–¥ –≤–µ—Ç–∫–∞", "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è —á–∞—Å—Ç—å"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        title: "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä –ø–æ–¥ –∫–ª—é—á",
        description: "–ü–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–Ω–∞—è –∫–ª–∏–Ω–∏–∫–∞",
        price: 45000000,
        pricePerMeter: 225000,
        address: "–ø—Ä. –≠–Ω–≥–µ–ª—å—Å–∞, 154",
        district: "–í—ã–±–æ—Ä–≥—Å–∫–∏–π",
        propertyType: "medical",
        rooms: null,
        area: "200.0",
        floor: 1,
        totalFloors: 3,
        buildingType: "—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ",
        images: ["https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d?w=800"],
        features: ["–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ", "5 –∫–∞–±–∏–Ω–µ—Ç–æ–≤", "–†–µ–Ω—Ç–≥–µ–Ω", "–õ–∏—Ü–µ–Ω–∑–∏—è"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        title: "–°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã –≤ –¢–¶",
        description: "–ì–æ—Ç–æ–≤—ã–π –∫ —Ä–∞–±–æ—Ç–µ —Å–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã",
        price: 8500000,
        pricePerMeter: 170000,
        address: "–¢–¶ –ì–∞–ª–µ—Ä–µ—è, –õ–∏–≥–æ–≤—Å–∫–∏–π –ø—Ä., 30–ê",
        district: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π",
        propertyType: "beauty",
        rooms: null,
        area: "50.0",
        floor: 2,
        totalFloors: 5,
        buildingType: "—Ç–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä",
        images: ["https://images.unsplash.com/photo-1560066984-138dadb4c035?w=800"],
        features: ["4 —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç–∞", "–ú–∞–Ω–∏–∫—é—Ä–Ω–∞—è –∑–æ–Ω–∞", "–ö–∞–±–∏–Ω–µ—Ç –∫–æ—Å–º–µ—Ç–æ–ª–æ–≥–∞", "–†–µ–º–æ–Ω—Ç"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        title: "–§–∏—Ç–Ω–µ—Å-–∫–ª—É–± –ø—Ä–µ–º–∏—É–º-–∫–ª–∞—Å—Å–∞",
        description: "–ü–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–Ω—ã–π —Å–ø–æ—Ä—Ç–∑–∞–ª",
        price: 55000000,
        pricePerMeter: 137500,
        address: "–ö–∞–º–µ–Ω–Ω–æ–æ—Å—Ç—Ä–æ–≤—Å–∫–∏–π –ø—Ä., 42",
        district: "–ü–µ—Ç—Ä–æ–≥—Ä–∞–¥—Å–∫–∏–π",
        propertyType: "fitness",
        rooms: null,
        area: "400.0",
        floor: 1,
        totalFloors: 2,
        buildingType: "—Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–µ",
        images: ["https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=800"],
        features: ["–¢—Ä–µ–Ω–∞–∂–µ—Ä–Ω—ã–π –∑–∞–ª", "–ì—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–ª—ã", "–°–∞—É–Ω–∞", "–†–∞–∑–¥–µ–≤–∞–ª–∫–∏"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        title: "–ê–≤—Ç–æ—Å–µ—Ä–≤–∏—Å —Å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º",
        description: "–°—Ç–∞–Ω—Ü–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è",
        price: 28000000,
        pricePerMeter: 70000,
        address: "–ú–æ—Å–∫–æ–≤—Å–∫–æ–µ —à–æ—Å—Å–µ, 165",
        district: "–ú–æ—Å–∫–æ–≤—Å–∫–∏–π",
        propertyType: "auto",
        rooms: null,
        area: "400.0",
        floor: 1,
        totalFloors: 1,
        buildingType: "–ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–µ",
        images: ["https://images.unsplash.com/photo-1486262715619-67b85e0b08d3?w=800"],
        features: ["4 –ø–æ—Å—Ç–∞", "–ü–æ–¥—ä–µ–º–Ω–∏–∫–∏", "–ö–æ–º–ø—Ä–µ—Å—Å–æ—Ä", "–û—Ñ–∏—Å–Ω–∞—è —á–∞—Å—Ç—å"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        title: "–ó–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫ –ò–ñ–°",
        description: "–£—á–∞—Å—Ç–æ–∫ –¥–ª—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ –∂–∏–ª–∏—â–Ω–æ–≥–æ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞",
        price: 3500000,
        pricePerMeter: 35000,
        address: "–ø–æ—Å. –õ–µ–Ω–∏–Ω—Å–∫–æ–µ, —É–ª. –î–∞—á–Ω–∞—è",
        district: "–õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
        propertyType: "land",
        rooms: null,
        area: "100.0",
        floor: null,
        totalFloors: null,
        buildingType: "–∑–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫",
        images: ["https://images.unsplash.com/photo-1500382017468-9049fed747ef?w=800"],
        features: ["–ò–ñ–°", "–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ", "–ì–∞–∑ –ø–æ –≥—Ä–∞–Ω–∏—Ü–µ", "–•–æ—Ä–æ—à–∏–µ –ø–æ–¥—ä–µ–∑–¥–Ω—ã–µ –ø—É—Ç–∏"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        title: "–ì–∞—Ä–∞–∂ –≤ –ì–°–ö",
        description: "–ö–∞–ø–∏—Ç–∞–ª—å–Ω—ã–π –≥–∞—Ä–∞–∂ —Å –ø–æ–≥—Ä–µ–±–æ–º",
        price: 850000,
        pricePerMeter: 42500,
        address: "–ì–°–ö –ê–≤—Ç–æ–º–æ–±–∏–ª–∏—Å—Ç, –í–∞—Å–∏–ª—å–µ–≤—Å–∫–∏–π –æ—Å—Ç—Ä–æ–≤",
        district: "–í–∞—Å–∏–ª–µ–æ—Å—Ç—Ä–æ–≤—Å–∫–∏–π",
        propertyType: "garage",
        rooms: null,
        area: "20.0",
        floor: null,
        totalFloors: null,
        buildingType: "–≥–∞—Ä–∞–∂",
        images: ["https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800"],
        features: ["–ü–æ–≥—Ä–µ–±", "–≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ", "–û—Ö—Ä–∞–Ω–∞", "–£–¥–æ–±–Ω—ã–π –ø–æ–¥—ä–µ–∑–¥"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        title: "–ú–∞—à–∏–Ω–æ–º–µ—Å—Ç–æ –≤ –ø–æ–¥–∑–µ–º–Ω–æ–º –ø–∞—Ä–∫–∏–Ω–≥–µ",
        description: "–û—Ö—Ä–∞–Ω—è–µ–º–æ–µ –º–∞—à–∏–Ω–æ–º–µ—Å—Ç–æ –≤ –ñ–ö",
        price: 1200000,
        pricePerMeter: 80000,
        address: "–ñ–ö –°–µ–≤–µ—Ä–Ω–∞—è –î–æ–ª–∏–Ω–∞, –ü—Ä–∏–º–æ—Ä—Å–∫–∏–π —Ä-–Ω",
        district: "–ü—Ä–∏–º–æ—Ä—Å–∫–∏–π",
        propertyType: "parking",
        rooms: null,
        area: "15.0",
        floor: -1,
        totalFloors: null,
        buildingType: "–ø–æ–¥–∑–µ–º–Ω—ã–π –ø–∞—Ä–∫–∏–Ω–≥",
        images: ["https://images.unsplash.com/photo-1590674899484-d5640e854abe?w=800"],
        features: ["–ü–æ–¥–∑–µ–º–Ω—ã–π –ø–∞—Ä–∫–∏–Ω–≥", "–û—Ö—Ä–∞–Ω–∞ 24/7", "–í–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ", "–í–µ–Ω—Ç–∏–ª—è—Ü–∏—è"],
        isActive: true,
        createdAt: new Date(),
      }
    ];

    sampleProperties.forEach(property => {
      this.properties.set(property.id, property);
    });
  }

  private initializeNewBuildings() {
    const sampleBuildings: NewBuilding[] = [
      {
        id: this.currentId++,
        name: "–ñ–ö –°–µ–≤–µ—Ä–Ω—ã–π –ü–∞—Ä–∫",
        description: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∂–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å —Å —Ä–∞–∑–≤–∏—Ç–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∏ –¥–µ—Ç—Å–∫–∏–º —Å–∞–¥–æ–º",
        location: "–ü—Ä–∏–º–æ—Ä—Å–∫–∏–π —Ä–∞–π–æ–Ω, –º. –ö–æ–º–µ–Ω–¥–∞–Ω—Ç—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç",
        developer: "–ü–°–ö –ì—Ä—É–ø–ø–∞",
        completionYear: 2025,
        priceFrom: 4200000,
        pricePerMeter: 115000,
        totalFlats: 324,
        readiness: "75% –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏",
        images: ["https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=800&h=600&fit=crop"],
        features: ["–î–µ—Ç—Å–∫–∏–π —Å–∞–¥", "–§–∏—Ç–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä", "–ü–æ–¥–∑–µ–º–Ω—ã–π –ø–∞—Ä–∫–∏–Ω–≥", "–ö–æ–Ω—Å—å–µ—Ä–∂"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        name: "–ñ–ö –ú–æ—Å–∫–æ–≤—Å–∫–∏–µ –í–æ—Ä–æ—Ç–∞",
        description: "–ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–π –∂–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å –≤ —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞ —Å –ø–∞–Ω–æ—Ä–∞–º–Ω—ã–º–∏ –≤–∏–¥–∞–º–∏",
        location: "–ú–æ—Å–∫–æ–≤—Å–∫–∏–π —Ä–∞–π–æ–Ω, –º. –ú–æ—Å–∫–æ–≤—Å–∫–∏–µ –í–æ—Ä–æ—Ç–∞",
        developer: "–õ–°–†. –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å",
        completionYear: 2024,
        priceFrom: 7800000,
        pricePerMeter: 195000,
        totalFlats: 180,
        readiness: "–ì–æ—Ç–æ–≤ –∫ –∑–∞—Å–µ–ª–µ–Ω–∏—é",
        images: ["https://images.unsplash.com/photo-1582407947304-fd86f028f716?w=800&h=600&fit=crop"],
        features: ["–í–∏–¥–æ–≤—ã–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã", "SPA-–∑–æ–Ω–∞", "–ü–∞—Ä–∫–∏–Ω–≥", "–û—Ö—Ä–∞–Ω–∞ 24/7"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        name: "–ñ–ö Green Park",
        description: "–≠–∫–æ–ª–æ–≥–∏—á–Ω—ã–π –∂–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å —Å—Ä–µ–¥–∏ –∑–µ–ª–µ–Ω—ã—Ö –Ω–∞—Å–∞–∂–¥–µ–Ω–∏–π",
        location: "–í—ã–±–æ—Ä–≥—Å–∫–∏–π —Ä–∞–π–æ–Ω, –º. –û–∑–µ—Ä–∫–∏",
        developer: "–ì—Ä—É–ø–ø–∞ –¶–î–°",
        completionYear: 2025,
        priceFrom: 3900000,
        pricePerMeter: 108000,
        totalFlats: 450,
        readiness: "–ò–¥–µ—Ç –æ—Ç–¥–µ–ª–∫–∞",
        images: ["https://images.unsplash.com/photo-1555636222-cae831e670b3?w=800&h=600&fit=crop"],
        features: ["–≠–∫–æ-–º–∞—Ç–µ—Ä–∏–∞–ª—ã", "–î–µ—Ç—Å–∫–∏–µ –ø–ª–æ—â–∞–¥–∫–∏", "–í–µ–ª–æ–ø–∞—Ä–∫–æ–≤–∫–∞", "–ó–µ–ª–µ–Ω—ã–π –¥–≤–æ—Ä"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        name: "–ñ–ö –ù–µ–≤—Å–∫–∏–π –°—Ç–∏–ª—å",
        description: "–≠–ª–∏—Ç–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å —Å –∞–≤—Ç–æ—Ä—Å–∫–∏–º–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞–º–∏ –∏ –ø—Ä–µ–º–∏—É–º –æ—Ç–¥–µ–ª–∫–æ–π",
        location: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω, –Ω–∞–±. —Ä–µ–∫–∏ –§–æ–Ω—Ç–∞–Ω–∫–∏",
        developer: "RBI",
        completionYear: 2026,
        priceFrom: 12500000,
        pricePerMeter: 285000,
        totalFlats: 96,
        readiness: "–ó–∞–ª–æ–∂–µ–Ω —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç",
        images: ["https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=800&h=600&fit=crop"],
        features: ["–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞", "–ö–≤–∞—Ä—Ç–∏—Ä—ã —Å —Ç–µ—Ä—Ä–∞—Å–∞–º–∏", "–ö–æ–Ω—Å—å–µ—Ä–∂", "–≠–ª–∏—Ç–Ω–∞—è –æ—Ç–¥–µ–ª–∫–∞"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        name: "–ñ–ö –ù–æ–≤—ã–π –ì–æ—Ä–∏–∑–æ–Ω—Ç",
        description: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∂–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å –∫–æ–º—Ñ–æ—Ä—Ç-–∫–ª–∞—Å—Å–∞ —Å —Ä–∞–∑–≤–∏—Ç–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π",
        location: "–ö–∏—Ä–æ–≤—Å–∫–∏–π —Ä–∞–π–æ–Ω, –º. –õ–µ–Ω–∏–Ω—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç",
        developer: "–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π —Ç—Ä–µ—Å—Ç",
        completionYear: 2027,
        priceFrom: 5200000,
        pricePerMeter: 130000,
        totalFlats: 600,
        readiness: "–ü—Ä–æ–µ–∫—Ç —É—Ç–≤–µ—Ä–∂–¥–µ–Ω",
        images: ["https://images.unsplash.com/photo-1571055107559-3e67626fa8be?w=800&h=600&fit=crop"],
        features: ["–®–∫–æ–ª–∞", "–ü–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞", "–¢–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä", "–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø–∞—Ä–∫–∏–Ω–≥"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        name: "–ñ–ö –í–∞—Å–∏–ª—å–µ–≤—Å–∫–∏–π",
        description: "–£—é—Ç–Ω—ã–π –∂–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å –Ω–∞ –í–∞—Å–∏–ª—å–µ–≤—Å–∫–æ–º –æ—Å—Ç—Ä–æ–≤–µ —Ä—è–¥–æ–º —Å –º–µ—Ç—Ä–æ",
        location: "–í–∞—Å–∏–ª–µ–æ—Å—Ç—Ä–æ–≤—Å–∫–∏–π —Ä–∞–π–æ–Ω, –º. –í–∞—Å–∏–ª–µ–æ—Å—Ç—Ä–æ–≤—Å–∫–∞—è",
        developer: "Setl Group",
        completionYear: 2024,
        priceFrom: 6700000,
        pricePerMeter: 167000,
        totalFlats: 210,
        readiness: "–í–µ–¥–µ—Ç—Å—è –æ—Ç–¥–µ–ª–∫–∞",
        images: ["https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=800&h=600&fit=crop"],
        features: ["–ë–ª–∏–∑–∫–æ –∫ –º–µ—Ç—Ä–æ", "–î–≤–æ—Ä –±–µ–∑ –º–∞—à–∏–Ω", "–ü–æ–¥–∑–µ–º–Ω–∞—è –ø–∞—Ä–∫–æ–≤–∫–∞", "–ö–ª–∞–¥–æ–≤—ã–µ"],
        isActive: true,
        createdAt: new Date(),
      }
    ];

    sampleBuildings.forEach(building => {
      this.newBuildings.set(building.id, building);
    });
  }

  private initializeServices() {
    const sampleServices: Service[] = [
      {
        id: this.currentId++,
        name: "–ü—Ä–µ–¥–ø—Ä–æ–¥–∞–∂–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞",
        description: "–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –∫ –ø—Ä–æ–¥–∞–∂–µ",
        shortDescription: "–ü–æ–¥–≥–æ—Ç–æ–≤–∏–º –≤–∞—à—É –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∂–µ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏",
        icon: "fas fa-hammer",
        price: "–æ—Ç 50 000 ‚ÇΩ",
        features: ["–û—Ü–µ–Ω–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è", "–ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π", "–ö–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–º–æ–Ω—Ç"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        name: "–î–∏–∑–∞–π–Ω-–ø—Ä–æ–µ–∫—Ç",
        description: "–°–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞ –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞",
        shortDescription: "–°–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞ –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞ –ø–æ–¥ –≤–∞—à–∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏",
        icon: "fas fa-paint-brush",
        price: "–æ—Ç 3 000 ‚ÇΩ/–º¬≤",
        features: ["3D –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è", "–ü–ª–∞–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è", "–ü–æ–¥–±–æ—Ä –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤"],
        isActive: true,
        createdAt: new Date(),
      },
      {
        id: this.currentId++,
        name: "–ó–µ–º–ª—è",
        description: "–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —É—Å–ª—É–≥–∏ –ø–æ –∑–µ–º–µ–ª—å–Ω—ã–º —É—á–∞—Å—Ç–∫–∞–º",
        shortDescription: "–ü–æ–¥–±–æ—Ä —É—á–∞—Å—Ç–∫–æ–≤, —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –∏ –ø–æ–º–æ—â—å –≤ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–µ",
        icon: "fas fa-seedling",
        price: "–æ—Ç 100 000 ‚ÇΩ",
        features: ["–ü–æ–¥–±–æ—Ä —É—á–∞—Å—Ç–∫–∞", "–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤", "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π", "–†–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ"],
        isActive: true,
        createdAt: new Date(),
      }
    ];

    sampleServices.forEach(service => {
      this.services.set(service.id, service);
    });
  }

  private initializeTeamMembers() {
    const sampleMembers: TeamMember[] = [
      {
        id: this.currentId++,
        name: "–ê–Ω–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞",
        position: "–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –æ—Ç–¥–µ–ª–∞ –ø—Ä–æ–¥–∞–∂",
        experience: "–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã: 8 –ª–µ—Ç",
        photo: "https://images.unsplash.com/photo-1494790108755-2616b5c1b1e4?w=400",
        phone: "+7 (812) 123-45-67",
        telegram: "@anna_petro",
        whatsapp: "+78121234567",
        specialization: ["–ü—Ä–æ–¥–∞–∂–∞ –∫–≤–∞—Ä—Ç–∏—Ä", "–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏"],
        isActive: true,
      }
    ];

    sampleMembers.forEach(member => {
      this.teamMembers.set(member.id, member);
    });
  }

  private initializeReviews() {
    const sampleReviews: Review[] = [
      {
        id: this.currentId++,
        clientName: "–î–º–∏—Ç—Ä–∏–π –ò–≤–∞–Ω–æ–≤",
        rating: 5,
        review: "–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –ü–æ–º–æ–≥–ª–∏ –ø—Ä–æ–¥–∞—Ç—å –∫–≤–∞—Ä—Ç–∏—Ä—É –∑–∞ 2 –Ω–µ–¥–µ–ª–∏ –ø–æ —Ö–æ—Ä–æ—à–µ–π —Ü–µ–Ω–µ.",
        propertyType: "–∫–≤–∞—Ä—Ç–∏—Ä–∞",
        serviceType: "–ø—Ä–æ–¥–∞–∂–∞",
        isPublished: true,
        createdAt: new Date(),
      }
    ];

    sampleReviews.forEach(review => {
      this.reviews.set(review.id, review);
    });
  }

  private initializeBlogPosts() {
    const samplePosts: BlogPost[] = [
      {
        id: this.currentId++,
        title: "–ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –∫–≤–∞—Ä—Ç–∏—Ä—É –≤ –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–µ",
        slug: "kak-vybrat-kvartiru-v-novostroike",
        excerpt: "–ü–æ–¥—Ä–æ–±–Ω—ã–π –≥–∏–¥ –ø–æ –≤—ã–±–æ—Ä—É –∫–≤–∞—Ä—Ç–∏—Ä—ã –≤ –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–µ",
        content: "–ü–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏...",
        author: "–ê–Ω–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞",
        category: "–ü–æ–∫—É–ø–∫–∞",
        tags: ["–Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏", "–ø–æ–∫—É–ø–∫–∞", "—Å–æ–≤–µ—Ç—ã"],
        image: "https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=800",
        isPublished: true,
        createdAt: new Date(),
        updatedAt: new Date(),
      }
    ];

    samplePosts.forEach(post => {
      this.blogPosts.set(post.id, post);
    });
  }

  private initializePromotions() {
    const samplePromotions: Promotion[] = [
      {
        id: this.currentId++,
        title: "–°–∫–∏–¥–∫–∞ 5% –Ω–∞ –ø–æ–∫—É–ø–∫—É –∫–≤–∞—Ä—Ç–∏—Ä—ã",
        description: "–ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã —á–µ—Ä–µ–∑ –Ω–∞—à–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ –ø–æ–ª—É—á–∏—Ç–µ —Å–∫–∏–¥–∫—É 5% –Ω–∞ –∫–æ–º–∏—Å—Å–∏—é. –ê–∫—Ü–∏—è –¥–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞.",
        discountType: "percentage",
        discountValue: "5%",
        category: "buy",
        backgroundColor: "#2563eb",
        textColor: "#ffffff",
        buttonText: "–ö—É–ø–∏—Ç—å —Å–æ —Å–∫–∏–¥–∫–æ–π",
        priority: 100,
        isActive: true,
        validUntil: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), // 30 days from now
        createdAt: new Date()
      },
      {
        id: this.currentId++,
        title: "–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏",
        description: "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –≤–∞—à–µ–π –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ. –£–∑–Ω–∞–π—Ç–µ —Ä–µ–∞–ª—å–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ 24 —á–∞—Å–∞.",
        discountType: "special",
        discountValue: "0‚ÇΩ",
        category: "sell",
        backgroundColor: "#059669",
        textColor: "#ffffff",
        buttonText: "–ü–æ–ª—É—á–∏—Ç—å –æ—Ü–µ–Ω–∫—É",
        priority: 90,
        isActive: true,
        validUntil: null,
        createdAt: new Date()
      },
      {
        id: this.currentId++,
        title: "–ü–µ—Ä–≤—ã–π –º–µ—Å—è—Ü –∞—Ä–µ–Ω–¥—ã –≤ –ø–æ–¥–∞—Ä–æ–∫",
        description: "–ü—Ä–∏ –∞—Ä–µ–Ω–¥–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã —á–µ—Ä–µ–∑ –Ω–∞—à–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü –∞—Ä–µ–Ω–¥—ã –∑–∞ –Ω–∞—à —Å—á–µ—Ç –¥–ª—è –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.",
        discountType: "fixed",
        discountValue: "1 –º–µ—Å—è—Ü",
        category: "rent",
        backgroundColor: "#dc2626",
        textColor: "#ffffff",
        buttonText: "–ê—Ä–µ–Ω–¥–æ–≤–∞—Ç—å",
        priority: 85,
        isActive: true,
        validUntil: new Date(Date.now() + 15 * 24 * 60 * 60 * 1000), // 15 days from now
        createdAt: new Date()
      },
      {
        id: this.currentId++,
        title: "–°–∫–∏–¥–∫–∞ –Ω–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —É—Å–ª—É–≥–∏",
        description: "–ü–æ–ª—É—á–∏—Ç–µ —Å–∫–∏–¥–∫—É 15% –Ω–∞ –≤—Å–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —É—Å–ª—É–≥–∏ –ø—Ä–∏ —Å–¥–µ–ª–∫–∞—Ö —Å –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é.",
        discountType: "percentage",
        discountValue: "15%",
        category: "services",
        backgroundColor: "#7c3aed",
        textColor: "#ffffff",
        buttonText: "–ü–æ–ª—É—á–∏—Ç—å —Å–∫–∏–¥–∫—É",
        priority: 80,
        isActive: true,
        validUntil: new Date(Date.now() + 45 * 24 * 60 * 60 * 1000), // 45 days from now
        createdAt: new Date()
      },
      {
        id: this.currentId++,
        title: "–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏",
        description: "–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –æ—Ç –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–æ–≤: —Å–∫–∏–¥–∫–∏ –¥–æ 10% –∏ —Ä–∞—Å—Å—Ä–æ—á–∫–∞ –±–µ–∑ –ø–µ—Ä–µ–ø–ª–∞—Ç.",
        discountType: "percentage",
        discountValue: "–¥–æ 10%",
        category: "new-buildings",
        backgroundColor: "#ea580c",
        textColor: "#ffffff",
        buttonText: "–°–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è",
        priority: 95,
        isActive: true,
        validUntil: new Date(Date.now() + 60 * 24 * 60 * 60 * 1000), // 60 days from now
        createdAt: new Date()
      },
      {
        id: this.currentId++,
        title: "–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ",
        description: "–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —É—Å–ª—É–≥ –ø–æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ —Å–æ —Å–∫–∏–¥–∫–æ–π 20% –ø—Ä–∏ –∑–∞–∫–∞–∑–µ –ø–∞–∫–µ—Ç–∞ —É—Å–ª—É–≥.",
        discountType: "percentage",
        discountValue: "20%",
        category: "all",
        backgroundColor: "#0891b2",
        textColor: "#ffffff",
        buttonText: "–ó–∞–∫–∞–∑–∞—Ç—å –ø–∞–∫–µ—Ç",
        priority: 75,
        isActive: true,
        validUntil: null,
        createdAt: new Date()
      }
    ];

    samplePromotions.forEach(promotion => {
      this.promotions.set(promotion.id, promotion);
    });
  }

  // User methods
  async getUser(id: number): Promise<User | undefined> {
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', { userId: id });
    return this.users.get(id);
  }

  async getUserByUsername(username: string): Promise<User | undefined> {
    storageLogger.debug('–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∏–º–µ–Ω–∏', { username });
    return Array.from(this.users.values()).find(user => user.username === username);
  }

  async createUser(insertUser: InsertUser): Promise<User> {
    const startTime = Date.now();
    storageLogger.info('–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', { username: insertUser.username });
    
    const id = this.currentId++;
    const user: User = { ...insertUser, id };
    this.users.set(id, user);
    
    const duration = Date.now() - startTime;
    storageLogger.info('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω', { 
      userId: id, 
      username: user.username,
      duration: `${duration}ms`
    });
    
    return user;
  }

  // Property methods
  async getProperties(filters?: any): Promise<Property[]> {
    const startTime = Date.now();
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏', { filters });
    
    let properties = Array.from(this.properties.values()).filter(p => p.isActive);
    const originalCount = properties.length;
    
    if (filters) {
      if (filters.propertyType) {
        properties = properties.filter(p => p.propertyType === filters.propertyType);
      }
      if (filters.district) {
        properties = properties.filter(p => p.district === filters.district);
      }
      if (filters.priceFrom) {
        properties = properties.filter(p => p.price >= filters.priceFrom);
      }
      if (filters.priceTo) {
        properties = properties.filter(p => p.price <= filters.priceTo);
      }
      if (filters.buildingType) {
        properties = properties.filter(p => p.buildingType === filters.buildingType);
      }
      if (filters.rooms) {
        properties = properties.filter(p => p.rooms === filters.rooms);
      }
    }
    
    const duration = Date.now() - startTime;
    storageLogger.debug('–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–∞', { 
      originalCount,
      filteredCount: properties.length,
      filters,
      duration: `${duration}ms`
    });
    
    return properties;
  }

  async getProperty(id: number): Promise<Property | undefined> {
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏', { propertyId: id });
    const property = this.properties.get(id);
    
    if (property) {
      storageLogger.debug('–û–±—ä–µ–∫—Ç –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –Ω–∞–π–¥–µ–Ω', { 
        propertyId: id, 
        title: property.title,
        price: property.price 
      });
    } else {
      storageLogger.warn('–û–±—ä–µ–∫—Ç –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω', { propertyId: id });
    }
    
    return property;
  }

  async createProperty(property: InsertProperty): Promise<Property> {
    const startTime = Date.now();
    storageLogger.info('–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏', { 
      title: property.title,
      price: property.price,
      propertyType: property.propertyType 
    });
    
    const id = this.currentId++;
    const newProperty: Property = { 
      ...property,
      id, 
      createdAt: new Date(),
      pricePerMeter: property.pricePerMeter ?? null,
      rooms: property.rooms ?? null,
      floor: property.floor ?? null,
      totalFloors: property.totalFloors ?? null,
      buildingType: property.buildingType ?? null,
      features: property.features ?? null,
      images: property.images ?? [],
      isActive: property.isActive ?? true
    };
    this.properties.set(id, newProperty);
    
    const duration = Date.now() - startTime;
    storageLogger.info('–û–±—ä–µ–∫—Ç –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–Ω', { 
      propertyId: id,
      title: newProperty.title,
      duration: `${duration}ms`
    });
    
    return newProperty;
  }

  // New Building methods
  async getNewBuildings(): Promise<NewBuilding[]> {
    const startTime = Date.now();
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –Ω–æ–≤–æ—Å—Ç—Ä–æ–µ–∫');
    
    const buildings = Array.from(this.newBuildings.values()).filter(b => b.isActive);
    
    const duration = Date.now() - startTime;
    storageLogger.debug('–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', { 
      count: buildings.length,
      duration: `${duration}ms`
    });
    
    return buildings;
  }

  async getNewBuilding(id: number): Promise<NewBuilding | undefined> {
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏', { buildingId: id });
    const building = this.newBuildings.get(id);
    
    if (building) {
      storageLogger.debug('–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–π–¥–µ–Ω–∞', { 
        buildingId: id, 
        name: building.name 
      });
    } else {
      storageLogger.warn('–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', { buildingId: id });
    }
    
    return building;
  }

  async createNewBuilding(building: InsertNewBuilding): Promise<NewBuilding> {
    const startTime = Date.now();
    storageLogger.info('–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏', { name: building.name });
    
    const id = this.currentId++;
    const newBuilding: NewBuilding = { 
      ...building, 
      id, 
      createdAt: new Date(),
      completionYear: building.completionYear ?? null,
      pricePerMeter: building.pricePerMeter ?? null,
      totalFlats: building.totalFlats ?? null,
      readiness: building.readiness ?? null,
      images: building.images ?? [],
      features: building.features ?? null,
      isActive: building.isActive ?? true
    };
    this.newBuildings.set(id, newBuilding);
    
    const duration = Date.now() - startTime;
    storageLogger.info('–ù–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∞ —Å–æ–∑–¥–∞–Ω–∞', { 
      buildingId: id,
      name: newBuilding.name,
      duration: `${duration}ms`
    });
    
    return newBuilding;
  }

  // Service methods
  async getServices(): Promise<Service[]> {
    const startTime = Date.now();
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —É—Å–ª—É–≥');
    
    const services = Array.from(this.services.values()).filter(s => s.isActive);
    
    const duration = Date.now() - startTime;
    storageLogger.debug('–£—Å–ª—É–≥–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', { 
      count: services.length,
      duration: `${duration}ms`
    });
    
    return services;
  }

  async getService(id: number): Promise<Service | undefined> {
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ —É—Å–ª—É–≥–∏', { serviceId: id });
    const service = this.services.get(id);
    
    if (service) {
      storageLogger.debug('–£—Å–ª—É–≥–∞ –Ω–∞–π–¥–µ–Ω–∞', { 
        serviceId: id, 
        name: service.name 
      });
    } else {
      storageLogger.warn('–£—Å–ª—É–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', { serviceId: id });
    }
    
    return service;
  }

  async createService(service: InsertService): Promise<Service> {
    const startTime = Date.now();
    storageLogger.info('–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —É—Å–ª—É–≥–∏', { name: service.name });
    
    const id = this.currentId++;
    const newService: Service = { 
      ...service, 
      id, 
      createdAt: new Date(),
      price: service.price ?? null,
      features: service.features ?? null,
      isActive: service.isActive ?? true
    };
    this.services.set(id, newService);
    
    const duration = Date.now() - startTime;
    storageLogger.info('–£—Å–ª—É–≥–∞ —Å–æ–∑–¥–∞–Ω–∞', { 
      serviceId: id,
      name: newService.name,
      duration: `${duration}ms`
    });
    
    return newService;
  }

  // Team Member methods
  async getTeamMembers(): Promise<TeamMember[]> {
    const startTime = Date.now();
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤');
    
    const members = Array.from(this.teamMembers.values()).filter(m => m.isActive);
    
    const duration = Date.now() - startTime;
    storageLogger.debug('–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', { 
      count: members.length,
      duration: `${duration}ms`
    });
    
    return members;
  }

  async getTeamMember(id: number): Promise<TeamMember | undefined> {
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞', { memberId: id });
    const member = this.teamMembers.get(id);
    
    if (member) {
      storageLogger.debug('–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –Ω–∞–π–¥–µ–Ω', { 
        memberId: id, 
        name: member.name 
      });
    } else {
      storageLogger.warn('–°–æ—Ç—Ä—É–¥–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω', { memberId: id });
    }
    
    return member;
  }

  async createTeamMember(member: InsertTeamMember): Promise<TeamMember> {
    const startTime = Date.now();
    storageLogger.info('–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞', { name: member.name });
    
    const id = this.currentId++;
    const newMember: TeamMember = { 
      ...member, 
      id,
      isActive: member.isActive ?? true,
      phone: member.phone ?? null,
      telegram: member.telegram ?? null,
      whatsapp: member.whatsapp ?? null,
      specialization: member.specialization ?? null
    };
    this.teamMembers.set(id, newMember);
    
    const duration = Date.now() - startTime;
    storageLogger.info('–°–æ—Ç—Ä—É–¥–Ω–∏–∫ —Å–æ–∑–¥–∞–Ω', { 
      memberId: id,
      name: newMember.name,
      duration: `${duration}ms`
    });
    
    return newMember;
  }

  // Lead methods
  async getLeads(): Promise<Lead[]> {
    const startTime = Date.now();
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞—è–≤–æ–∫');
    
    const leads = Array.from(this.leads.values());
    
    const duration = Date.now() - startTime;
    storageLogger.debug('–ó–∞—è–≤–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', { 
      count: leads.length,
      duration: `${duration}ms`
    });
    
    return leads;
  }

  async createLead(lead: InsertLead): Promise<Lead> {
    const startTime = Date.now();
    storageLogger.info('üéØ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞—è–≤–∫–∏', { 
      name: lead.name,
      phone: lead.phone,
      serviceType: lead.serviceType,
      propertyType: lead.propertyType,
      budget: lead.budget
    });
    
    const id = this.currentId++;
    const newLead: Lead = { 
      ...lead, 
      id, 
      status: "new",
      source: "website",
      createdAt: new Date(),
      email: lead.email ?? null,
      propertyType: lead.propertyType ?? null,
      message: lead.message ?? null,
      budget: lead.budget ?? null
    };
    this.leads.set(id, newLead);
    
    const duration = Date.now() - startTime;
    storageLogger.info('‚úÖ –ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞', { 
      leadId: id,
      name: newLead.name,
      serviceType: newLead.serviceType,
      duration: `${duration}ms`
    });
    
    return newLead;
  }

  // Review methods
  async getReviews(): Promise<Review[]> {
    const startTime = Date.now();
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ—Ç–∑—ã–≤–æ–≤');
    
    const reviews = Array.from(this.reviews.values()).filter(r => r.isPublished);
    
    const duration = Date.now() - startTime;
    storageLogger.debug('–û—Ç–∑—ã–≤—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã', { 
      count: reviews.length,
      duration: `${duration}ms`
    });
    
    return reviews;
  }

  async createReview(review: InsertReview): Promise<Review> {
    const startTime = Date.now();
    storageLogger.info('–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ—Ç–∑—ã–≤–∞', { 
      name: review.name,
      rating: review.rating
    });
    
    const id = this.currentId++;
    const newReview: Review = { 
      ...review, 
      id, 
      isPublished: false,
      createdAt: new Date(),
      propertyType: review.propertyType ?? null,
      serviceType: review.serviceType ?? null
    };
    this.reviews.set(id, newReview);
    
    const duration = Date.now() - startTime;
    storageLogger.info('–û—Ç–∑—ã–≤ —Å–æ–∑–¥–∞–Ω (–æ–∂–∏–¥–∞–µ—Ç –º–æ–¥–µ—Ä–∞—Ü–∏–∏)', { 
      reviewId: id,
      name: newReview.name,
      rating: newReview.rating,
      duration: `${duration}ms`
    });
    
    return newReview;
  }

  // Blog Post methods
  async getBlogPosts(): Promise<BlogPost[]> {
    const startTime = Date.now();
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å—Ç–∞—Ç–µ–π –±–ª–æ–≥–∞');
    
    const posts = Array.from(this.blogPosts.values()).filter(p => p.isPublished);
    
    const duration = Date.now() - startTime;
    storageLogger.debug('–°—Ç–∞—Ç—å–∏ –±–ª–æ–≥–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', { 
      count: posts.length,
      duration: `${duration}ms`
    });
    
    return posts;
  }

  async getBlogPost(slug: string): Promise<BlogPost | undefined> {
    storageLogger.debug('–ü–æ–∏—Å–∫ —Å—Ç–∞—Ç—å–∏ –±–ª–æ–≥–∞ –ø–æ slug', { slug });
    
    const post = Array.from(this.blogPosts.values()).find(p => p.slug === slug && p.isPublished);
    
    if (post) {
      storageLogger.debug('–°—Ç–∞—Ç—å—è –±–ª–æ–≥–∞ –Ω–∞–π–¥–µ–Ω–∞', { 
        slug, 
        title: post.title,
        category: post.category 
      });
    } else {
      storageLogger.warn('–°—Ç–∞—Ç—å—è –±–ª–æ–≥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', { slug });
    }
    
    return post;
  }

  async createBlogPost(post: InsertBlogPost): Promise<BlogPost> {
    const startTime = Date.now();
    storageLogger.info('–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ç–∞—Ç—å–∏ –±–ª–æ–≥–∞', { 
      title: post.title,
      slug: post.slug,
      category: post.category
    });
    
    const id = this.currentId++;
    const newPost: BlogPost = { 
      ...post, 
      id, 
      createdAt: new Date(),
      updatedAt: new Date(),
      image: post.image ?? null,
      tags: post.tags ?? null,
      isPublished: post.isPublished ?? true
    };
    this.blogPosts.set(id, newPost);
    
    const duration = Date.now() - startTime;
    storageLogger.info('–°—Ç–∞—Ç—å—è –±–ª–æ–≥–∞ —Å–æ–∑–¥–∞–Ω–∞', { 
      postId: id,
      title: newPost.title,
      duration: `${duration}ms`
    });
    
    return newPost;
  }

  // Promotion methods
  async getPromotions(category?: string): Promise<Promotion[]> {
    const startTime = Date.now();
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞–∫—Ü–∏–π', { category });
    
    let promotions = Array.from(this.promotions.values()).filter(p => p.isActive);
    const originalCount = promotions.length;
    
    if (category && category !== "all") {
      promotions = promotions.filter(p => p.category === category || p.category === "all");
    }
    
    const sorted = promotions.sort((a, b) => b.priority - a.priority);
    
    const duration = Date.now() - startTime;
    storageLogger.debug('–ê–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', { 
      originalCount,
      filteredCount: sorted.length,
      category,
      duration: `${duration}ms`
    });
    
    return sorted;
  }

  async getPromotion(id: number): Promise<Promotion | undefined> {
    storageLogger.debug('–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ü–∏–∏', { promotionId: id });
    const promotion = this.promotions.get(id);
    
    if (promotion) {
      storageLogger.debug('–ê–∫—Ü–∏—è –Ω–∞–π–¥–µ–Ω–∞', { 
        promotionId: id, 
        title: promotion.title 
      });
    } else {
      storageLogger.warn('–ê–∫—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', { promotionId: id });
    }
    
    return promotion;
  }

  async createPromotion(promotion: InsertPromotion): Promise<Promotion> {
    const startTime = Date.now();
    storageLogger.info('–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∞–∫—Ü–∏–∏', { 
      title: promotion.title,
      category: promotion.category
    });
    
    const id = this.currentId++;
    const newPromotion: Promotion = { 
      ...promotion, 
      id, 
      createdAt: new Date(),
      discountValue: promotion.discountValue ?? null,
      discountType: promotion.discountType ?? null,
      validUntil: promotion.validUntil ?? null,
      isActive: promotion.isActive ?? true
    };
    this.promotions.set(id, newPromotion);
    
    const duration = Date.now() - startTime;
    storageLogger.info('–ê–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞', { 
      promotionId: id,
      title: newPromotion.title,
      duration: `${duration}ms`
    });
    
    return newPromotion;
  }
}

import { db } from "./db";
import { eq, like, and, gte, lte, or } from "drizzle-orm";

// Commented out MemStorage for database implementation
export const storage = new MemStorage();

export class DatabaseStorage implements IStorage {
  constructor() {
    storageLogger.processStart('Database storage initialization');
    storageLogger.info('–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö');
    // Database connection logic would go here
    storageLogger.processEnd('Database storage initialization');
  }

  async getUser(id: number): Promise<User | undefined> {
    const startTime = Date.now();
    try {
      storageLogger.debug('DB: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', { userId: id });
      // Database query here
      const [user] = await db.select().from(users).where(eq(users.id, id));
      const duration = Date.now() - startTime;
      storageLogger.dbQuery(`SELECT * FROM users WHERE id = $1`, [id], duration);
      return user || undefined;
    } catch (error) {
      storageLogger.dbError(`SELECT * FROM users WHERE id = $1`, error as Error, [id]);
      throw error;
    }
  }

  async getUserByUsername(username: string): Promise<User | undefined> {
    const startTime = Date.now();
    try {
      storageLogger.debug('DB: –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∏–º–µ–Ω–∏', { username });
      const [user] = await db.select().from(users).where(eq(users.username, username));
      const duration = Date.now() - startTime;
      storageLogger.dbQuery(`SELECT * FROM users WHERE username = $1`, [username], duration);
      return user || undefined;
    } catch (error) {
      storageLogger.dbError(`SELECT * FROM users WHERE username = $1`, error as Error, [username]);
      throw error;
    }
  }

  async createUser(insertUser: InsertUser): Promise<User> {
    const startTime = Date.now();
    storageLogger.info('–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', { username: insertUser.username });
    
    const [user] = await db
      .insert(users)
      .values(insertUser)
      .returning();
    
    const duration = Date.now() - startTime;
    storageLogger.info('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω', { 
      userId: user.id, 
      username: user.username,
      duration: `${duration}ms`
    });
    
    return user;
  }

  async getProperties(filters?: any): Promise<Property[]> {
    let query = db.select().from(properties);
    
    const conditions = [];
    if (filters?.propertyType) {
      conditions.push(eq(properties.propertyType, filters.propertyType));
    }
    if (filters?.district) {
      conditions.push(eq(properties.district, filters.district));
    }
    if (filters?.priceFrom) {
      conditions.push(gte(properties.price, filters.priceFrom));
    }
    if (filters?.priceTo) {
      conditions.push(lte(properties.price, filters.priceTo));
    }
    if (filters?.buildingType) {
      conditions.push(eq(properties.buildingType, filters.buildingType));
    }
    if (filters?.rooms) {
      conditions.push(eq(properties.rooms, filters.rooms));
    }

    if (conditions.length > 0) {
      return await db.select().from(properties).where(and(...conditions));
    }

    return await db.select().from(properties);
  }

  async getProperty(id: number): Promise<Property | undefined> {
    const startTime = Date.now();
    storageLogger.debug('DB: –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏', { propertyId: id });
    const [property] = await db.select().from(properties).where(eq(properties.id, id));
    const duration = Date.now() - startTime;
    storageLogger.dbQuery(`SELECT * FROM properties WHERE id = $1`, [id], duration);
    return property || undefined;
  }

  async createProperty(property: InsertProperty): Promise<Property> {
    const startTime = Date.now();
    storageLogger.info('–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏', { 
      title: property.title,
      price: property.price,
      propertyType: property.propertyType 
    });
    
    const [newProperty] = await db
      .insert(properties)
      .values(property)
      .returning();
    
    const duration = Date.now() - startTime;
    storageLogger.info('–û–±—ä–µ–∫—Ç –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–Ω', { 
      propertyId: newProperty.id,
      title: newProperty.title,
      duration: `${duration}ms`
    });
    
    return newProperty;
  }

  async getNewBuildings(): Promise<NewBuilding[]> {
    return await db.select().from(newBuildings);
  }

  async getNewBuilding(id: number): Promise<NewBuilding | undefined> {
    const [building] = await db.select().from(newBuildings).where(eq(newBuildings.id, id));
    return building || undefined;
  }

  async createNewBuilding(building: InsertNewBuilding): Promise<NewBuilding> {
    const [newBuilding] = await db
      .insert(newBuildings)
      .values(building)
      .returning();
    return newBuilding;
  }

  async getServices(): Promise<Service[]> {
    return await db.select().from(services);
  }

  async getService(id: number): Promise<Service | undefined> {
    const [service] = await db.select().from(services).where(eq(services.id, id));
    return service || undefined;
  }

  async createService(service: InsertService): Promise<Service> {
    const [newService] = await db
      .insert(services)
      .values(service)
      .returning();
    return newService;
  }

  async getTeamMembers(): Promise<TeamMember[]> {
    return await db.select().from(teamMembers);
  }

  async getTeamMember(id: number): Promise<TeamMember | undefined> {
    const [member] = await db.select().from(teamMembers).where(eq(teamMembers.id, id));
    return member || undefined;
  }

  async createTeamMember(member: InsertTeamMember): Promise<TeamMember> {
    const [newMember] = await db
      .insert(teamMembers)
      .values(member)
      .returning();
    return newMember;
  }

  async getLeads(): Promise<Lead[]> {
    return await db.select().from(leads);
  }

  async createLead(lead: InsertLead): Promise<Lead> {
    const [newLead] = await db
      .insert(leads)
      .values(lead)
      .returning();
    return newLead;
  }

  async getReviews(): Promise<Review[]> {
    return await db.select().from(reviews);
  }

  async createReview(review: InsertReview): Promise<Review> {
    const [newReview] = await db
      .insert(reviews)
      .values(review)
      .returning();
    return newReview;
  }

  async getBlogPosts(): Promise<BlogPost[]> {
    return await db.select().from(blogPosts);
  }

  async getBlogPost(slug: string): Promise<BlogPost | undefined> {
    const [post] = await db.select().from(blogPosts).where(eq(blogPosts.slug, slug));
    return post || undefined;
  }

  async createBlogPost(post: InsertBlogPost): Promise<BlogPost> {
    const [newPost] = await db
      .insert(blogPosts)
      .values(post)
      .returning();
    return newPost;
  }

  async getPromotions(category?: string): Promise<Promotion[]> {
    let results: Promotion[];
    
    if (category && category !== "all") {
      results = await db.select().from(promotions).where(
        and(
          eq(promotions.isActive, true),
          or(eq(promotions.category, category), eq(promotions.category, "all"))
        )
      );
    } else {
      results = await db.select().from(promotions).where(eq(promotions.isActive, true));
    }
    
    return results.sort((a, b) => b.priority - a.priority);
  }

  async getPromotion(id: number): Promise<Promotion | undefined> {
    const [promotion] = await db.select().from(promotions).where(eq(promotions.id, id));
    return promotion || undefined;
  }

  async createPromotion(promotion: InsertPromotion): Promise<Promotion> {
    const [newPromotion] = await db
      .insert(promotions)
      .values(promotion)
      .returning();
    return newPromotion;
  }
}

// –í—ã–±–∏—Ä–∞–µ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é storage –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
const useDatabase = process.env.USE_DATABASE === 'true';

if (useDatabase) {
  storageLogger.info('–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PostgreSQL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö');
  export const storage: IStorage = new DatabaseStorage();
} else {
  storageLogger.info('–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏');
  export const storage: IStorage = new MemStorage();
}
